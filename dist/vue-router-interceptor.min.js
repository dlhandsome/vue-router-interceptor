/*!
  * vue-router-interceptor v1.0.1
  * (c) 2018 Sail <awsomeduan@gmail.com>
  * @license MIT
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.VueRouterInterceptor=t()}(this,function(){"use strict";var r=function(u){if(!Array.isArray(u))throw new TypeError("Middleware stack must be an array!");for(var e=0,t=u;e<t.length;e+=1){var r=t[e];if("function"!=typeof r)throw new TypeError("Middleware must be composed of functions!")}return function(o,n){var i=-1;return function e(t){if(t<=i)return Promise.reject(new Error("next() called multiple times"));i=t;var r=u[t];t===u.length&&(r=n);if(!r)return Promise.resolve();try{return Promise.resolve(r(o,function(){return e(t+1)}))}catch(e){return Promise.reject(e)}}(0)}};var e=function(e){this.router=e,this.modulesMap={}},t={modules:{configurable:!0}};t.modules.get=function(){return Object.keys(this.modulesMap)},e.prototype.register=function(e){return this.modulesMap[e]||(this.modulesMap[e]=new o(e,this.router)),this.modulesMap[e]},e.prototype.listen=function(){var t=this;this.modules.forEach(function(e){t.modulesMap[e].listen()})},Object.defineProperties(e.prototype,t);var o=function(e,t){this.moduleName=e,this.middleware=[],this.router=t};return o.prototype.use=function(e){if("function"!=typeof e)throw new TypeError("middleware must be a function!");return this.middleware.push(e),this},o.prototype.callback=function(e,t){r(this.middleware)(e,t)},o.prototype.listen=function(){var o=this;this.router.beforeEach(function(e,t,r){e.matched.some(function(e){return e.meta[o.moduleName]})?o.callback({to:e,from:t,router:o.router},r):r()})},{Create:e,RegisterModule:o,version:"1.0.1"}});